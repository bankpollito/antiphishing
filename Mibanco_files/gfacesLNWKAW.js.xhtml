GFaces={rowsSelected:function(){var rowCount=$(".rowCheckbox input:checkbox:checked").length;if(rowCount>0){return true;}else{return false;}},filesUploading:false};GFaces.inputFileBrowser={popupToolFieldId:null,parentId:null,show:function(fieldId){this.popupToolFieldId=fieldId;},selectFile:function(path,dialog){var inputField=document.getElementById(this.popupToolFieldId);inputField.value=path;inputField.focus();$(inputField).trigger('input');}};GFaces.popupTool={open:function(fieldId,url,width,height,winname){popupToolFieldId=fieldId;scroll=1;winl=(screen.width-width)/2;wint=(screen.height-height)/2;settings="height="+height+",";settings+="width="+width+",";settings+="top="+wint+",";settings+="left="+winl+",";settings+="scrollbars="+scroll+",";settings+="resizable=yes";win=window.open(url,winname,settings);if(parseInt(navigator.appVersion)>=4){win.window.focus();}}};function LS_Selection(textareaElement){this.element=textareaElement;}
LS_Selection.prototype.create=function(){if(document.selection!=null&&this.element.selectionStart==null){return this._ieGetSelection();}else{return this._mozillaGetSelection();}}
LS_Selection.prototype._mozillaGetSelection=function(){return{start:this.element.selectionStart,end:this.element.selectionEnd};}
LS_Selection.prototype._ieGetSelection=function(){this.element.focus();var range=document.selection.createRange();var bookmark=range.getBookmark();var contents=this.element.value;var originalContents=contents;var marker=this._createSelectionMarker();while(contents.indexOf(marker)!=-1){marker=this._createSelectionMarker();}
var parent=range.parentElement();range.text=marker+range.text+marker;contents=this.element.value;var result={};result.start=contents.indexOf(marker);contents=contents.replace(marker,"");result.end=contents.indexOf(marker);this.element.value=originalContents;range.moveToBookmark(bookmark);range.select();return result;}
LS_Selection.prototype._createSelectionMarker=function(){return"##SELECTION_MARKER_"+Math.random()+"##";}
var VariablePopup={attachedToField:null,caretInfo:{start:0,end:0},component:null,popupName:'varPopup',showButton:function(obj){if(this.attachedToField!=null&&this.attachedToField.length>0){$('[id="'+this.attachedToField+'"]').addClass('Hidden');}
var nearbyButton=$(obj).parents('.gfaces-input-with-variable').next('td').find('button.Hidden');nearbyButton.removeClass('Hidden');this.attachedToField=$(nearbyButton).attr('id');this.component=obj;},showPopup:function(anchorId){var ls_selection=new LS_Selection(this.component);var s=ls_selection.create();this.caretInfo.start=s.start;this.caretInfo.end=s.end;PF(this.popupName).show();return false;},insertVariable:function(evt){var newValue="${"+evt+"}";var val=this.component.value;if($(this.component).hasClass('encryptedField')){val=this.component.getHidden().value;}
var beginning=val.substr(0,this.caretInfo.start);var end=val.substr(this.caretInfo.end,val.length);newValue=beginning+newValue+end;this.setValue(newValue);this.component.focus();PF(this.popupName).hide();},replaceVariable:function(evt){var newValue="${"+evt+"}";this.setValue(newValue);this.component.focus();PF(this.popupName).hide();},setValue:function(value){var comp=this.component;$(comp).trigger('input');if($(comp).hasClass('encryptedField')){comp.applyValue(value);}else{comp.value=value;}}};var QuickHelp={show:function(caller,helpText,defaultValue,additionalInfoURL){var id=$(caller).attr('id');$('.QuickHelpPanel').removeClass('Hidden');$('.QuickHelpText').html(helpText);var QHDPanel=$('.QHDPanel');if(defaultValue!=''){QHDPanel.removeClass('Hidden');$('.QuickHelpDefault').html(defaultValue);}else{QHDPanel.addClass('Hidden');}
var QHAIPanel=$('.QHAIPanel');if(additionalInfoURL!=''){QHAIPanel.removeClass('Hidden');QuickHelp._loadAddInfoURL(additionalInfoURL);}else{QHAIPanel.addClass('Hidden');}
PF('QuickHelpPanel').show(id);},_loadAddInfoURL:function(url){if(url.indexOf('javascript:')==0){url=url.substring(11);}else{if(!url.indexOf('http://')==0){url=window.location.host+url;}
url="GFaces.popupTool.open(null,'"+url+"', '800', '600',null)";}
$('.QuickHelpAddInfo').attr('onclick',url+"; return false;");}}
GFaces.getBrowserInfo=function(){try{var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return{name:'IE',version:(tem[1]||'')};}
if(M[1]==='Chrome'){tem=ua.match(/\bOPR\/(\d+)/)
if(tem!=null){return{name:'Opera',version:tem[1]};}}
M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,'-?'];if((tem=ua.match(/version\/(\d+)/i))!=null){M.splice(1,1,tem[1]);}
return{name:M[0],version:M[1]};}catch(err){return{name:"Unknown",version:0};}}
function htmlEncode(value){return $('<div/>').text(value).html();}
function FMCOpenHelp(id,skinName,searchQuery,firstPick,pathToHelpSystem){MadCap.OpenHelp(id,skinName,searchQuery,firstPick,pathToHelpSystem);}
var ChangeHandler={init:function(cfg){var $this=this;this.iframeMode=parent!==window;this.cachedButtonClicks=[];if(this.iframeMode){parent.ChangeHandler=this;$(window).on('beforeunload',function(event){var cachedClicks=ChangeHandler.cachedButtonClicks;for(var x in cachedClicks){var cached=cachedClicks[x];$(cached.button).attr('onclick',cached.click);}
ChangeHandler.initialized=false;});}
this.handledResponse=false;this.cachedClick=null;this.hashref=false;this.options={saveSelector:cfg.saveSelector||'.SaveButton',changeListener:cfg.changeListener||changesMade,savePromptWidgetVar:cfg.promptWidgetVar||'SavePrompt',beforeNavigateFunction:cfg.beforeNavigateFunction,beforeNavigateFunctionHREF:cfg.beforeNavigateFunctionHREF,hiddenHREFSelector:cfg.hiddenHREFSelector||'.HiddenHREF'};$(document).on('click',$this.options.saveSelector,function(){$($this.options.hiddenHREFSelector).val('');});var ignoreInputSelector=cfg.ignoreInputSelector!=undefined?', '+cfg.ignoreInputSelector:'';var ignoreAutoCompleteEvent=cfg.ignoreAutoCompleteEvent!=undefined?cfg.ignoreAutoCompleteEvent:false;this.hasChanges=cfg.hasChanges||false;this.targetHeader=cfg.targetHeader||'#layoutTop a:not(.ui-submenu-link)';if(this.iframeMode){this.addPromptListener(this.targetHeader,undefined,window.parent.document);}else{this.addPromptListener(this.targetHeader);}
var inputSelector=':input:not(.ui-dialog :input'+ignoreInputSelector+')'
$(document).on('input',inputSelector,this.changesMade);var inputTypeSelector='input:checkbox:not(.ui-dialog :input:checkbox'+ignoreInputSelector+'), select:not(.ui-dialog select'+ignoreInputSelector+'), input:radio:not(.ui-dialog :input:radio'+ignoreInputSelector+')'
$(document).on('change',inputTypeSelector,this.changesMade);var _spin=PrimeFaces.widget.Spinner.prototype.spin;PrimeFaces.widget.Spinner.prototype.spin=function(dir){_spin.call(this,dir);ChangeHandler.changesMade();}
$(document).on('sortupdate','.ui-picklist-target',this.changesMade);$(document).on('dblclick','.ui-picklist-item',this.changesMade);$(document).on('click','.ui-picklist-buttons :button',this.changesMade);if(!ignoreAutoCompleteEvent){$(document).on('click','.ui-autocomplete-item',this.changesMade);}
$(document).on('keydown',inputSelector,this.handleDelete);$(document).on('cut',inputSelector,function(){ChangeHandler.changesMade();});this.initialized=true;},handleDelete:function(event){var key=event.which;if(key==8||key==46){ChangeHandler.changesMade();}},changesMade:function(){var $this=ChangeHandler;if(!$this.initialized||$this.hasChanges){return;}
var opts=$this.options;var saveBtn=$(opts.saveSelector);saveBtn.removeAttr('disabled');saveBtn.removeClass('ui-state-disabled');$this.hasChanges=true;if(opts.changeListener){opts.changeListener();}},promptSave:function(event,sender,args){var $this=ChangeHandler;var opts=$this.options;if(!$this.initialized){return true;}
if($this.hasChanges&&!$this.handledResponse){$this.cachedClick=sender||this;var href=$($this.cachedClick).attr('href');if(href==null||href=="#"){$this.hashref=false;}else{$this.hashref=true;$(opts.hiddenHREFSelector).val(href);}
PF(opts.savePromptWidgetVar).show();event.stopPropagation();return false;}
$this.handledResponse=false;if(opts.beforeNavigateFunction){opts.beforeNavigateFunction.apply(this,args);}
return true;},addPromptListener:function(selector,argsArray,doc){var selection;if(!doc){selection=$(selector);}else{selection=$(selector,doc);}
selection.each(function(){var btn=$(this);var currentClick=btn.attr('onclick');if(!currentClick){currentClick="return true;";}else{var cachedClick={'button':btn,'click':currentClick};ChangeHandler.cachedButtonClicks.push(cachedClick);}
btn.attr('onclick','if(ChangeHandler.promptSave(event, this,['+argsArray+'])) {'+currentClick+'} else { return false;}');});},handleSave:function(saveFunction){if(!ChangeHandler.hashref){saveFunction();return false;}
var opts=ChangeHandler.options;if(opts.beforeNavigateFunctionHREF){opts.beforeNavigateFunctionHREF.apply(this);}},handleNoSave:function(){var $this=ChangeHandler;$this.handledResponse=true;if($this.cachedClick){$this.cachedClick.click();}
return false;},handleCancel:function(){PF(ChangeHandler.options.savePromptWidgetVar).hide();$(ChangeHandler.options.hiddenHREFSelector).val('');return false;},setChangesMade:function(changesMade){ChangeHandler.hasChanges=changesMade;}};GFaces.PFOverride={init:function(){this.DateTimePicker();this.OverlayPanel();}}
GFaces.PFOverride.DateTimePicker=function(){if($.timepicker){$.timepicker.__proto__._addTimePicker=function(dp_inst){var currDT=$.trim((this.$altInput&&this._defaults.altFieldTimeOnly)?this.$input.val()+' '+this.$altInput.val():this.$input.next().val());this.timeDefined=this._parseTime(currDT);this._limitMinMaxDateTime(dp_inst,false);this._injectTimePicker();this._afterInject();};}
PrimeFaces.widget.Calendar.prototype.bindDateSelectListener=function(){var _self=this;this.cfg.onSelect=function(){if(_self.cfg.popup){_self.fireDateSelectEvent();if(_self.cfg.focusOnSelect){_self.refocusInput=true;_self.jqEl.focus();if(!(_self.cfg.showOn&&_self.cfg.showOn==='button')){_self.jqEl.off('click.calendar').on('click.calendar',function(){$(this).datepicker("show");});}
setTimeout(function(){_self.refocusInput=false;},10);}}else{var settingsObj={settings:_self.cfg};var newDate=_self.cfg.timeOnly?'':$.datepicker.formatDate(_self.cfg.dateFormat,_self.getDate(),$.datepicker._getFormatConfig(settingsObj));if(_self.cfg.timeFormat){newDate+=' '+_self.jqEl.find('.ui_tpicker_time_input')[0].value;}
_self.input.val(newDate);_self.fireDateSelectEvent();}};}}
GFaces.PFOverride.OverlayPanel=function(){PrimeFaces.widget.OverlayPanel.prototype.applyFocus=function(){var firstInput=this.jq.find(':not(:submit):not(:button):input:visible:enabled:first');if(firstInput.attr('type')=='radio'){firstInput=firstInput.closest('.ui-selectoneradio').find('.ui-state-active').prev().children('input');}
firstInput.focus();}}
GFaces.PFOverride.init();GFaces.onShowConfirm=function(dialog){var parent=dialog.jq.parent();var found=false;while(parent!=null&&parent.prop('tagName')){var position=parent.css('position').toLowerCase();if(position=='fixed'){found=true;break;}
parent=parent.parent();}
if(found){dialog.modalOverlay.remove();parent.prepend(dialog.modalOverlay);}}